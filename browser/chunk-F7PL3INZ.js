import{a as re,b as oe}from"./chunk-2NQN2QGK.js";import{a as L}from"./chunk-YTZWR7HQ.js";import{f as $,h as x}from"./chunk-QHPCZR37.js";import{b as q,c as z,e as W,f as H,h as J,i as K,j as Q,k as X,m as Y,n as Z,o as ee}from"./chunk-FCUR6AMQ.js";import"./chunk-EPUHCHQK.js";import{a as A}from"./chunk-XOQXPUWQ.js";import{a as G}from"./chunk-6KFB6HDE.js";import"./chunk-DIIPB7DZ.js";import"./chunk-LM6MGTWJ.js";import{a as te,b as ie}from"./chunk-6SO5ROY5.js";import{Ba as E,N as R,ma as C,na as D,oa as V,pa as I,q as M}from"./chunk-NN2CTZ2E.js";import{Bb as S,Cb as N,D as B,Kb as p,L as _,Lb as u,Mb as c,Ra as i,Sa as s,Sb as k,Tb as y,_ as h,ac as a,bc as l,f as g,fb as b,ia as U,ib as d,ja as O,k as T,nb as w,sb as r,tb as o,ub as f,x as F,yb as j}from"./chunk-7ILHC6KT.js";import"./chunk-MG3ERZGY.js";function de(m,t){m&1&&f(0,"app-overlay-loader")}var P=class m{constructor(t,e,n,v){this.fb=t;this.loaderService=e;this.userService=n;this.dialogRef=v;this.form=this.fb.group({fullname:"",email:["",z.required],phoneNumber:["",oe()]})}form;isLoading$;_destroying$=new g;ngOnInit(){this.setFormValues(),this.isLoading$=this.loaderService.isActive(3)}setFormValues(){let t=this.userService.activeUser;t&&this.form.setValue({fullname:t.fullname,email:t.email,phoneNumber:t.phoneNumber})}getFormControlByName(t){return this.form.get(t)}onSave(){if(this.form.valid){this.loaderService.setActive(3);let t={email:this.form.get("email")?.value,phoneNumber:this.form.get("phoneNumber")?.value,fullname:this.form.get("fullname")?.value};this.userService.updateUser$(t).pipe(F(()=>(this.dialogRef.close(!1),T())),B(()=>this.loaderService.setInactive(3)),_(this._destroying$)).subscribe(e=>{if(e.user){let n=this.userService.activeUser;n.email=e.user?.email,n.fullname=e.user.fullName,n.phoneNumber=e.user.phoneNumber,this.userService.activeUser=n,this.dialogRef.close(!0)}})}else Object.keys(this.form.controls).forEach(t=>{let e=this.form.get(t);e&&(e.markAsTouched(),e.markAsDirty(),e.updateValueAndValidity())})}ngOnDestroy(){this._destroying$.next(void 0),this._destroying$.complete()}static \u0275fac=function(e){return new(e||m)(s(X),s(A),s(E),s($))};static \u0275cmp=h({type:m,selectors:[["app-edit-profile-dialog"]],standalone:!0,features:[y],decls:22,vars:19,consts:[[1,"abms-edit-profile"],[1,"abms-edit-profile__form",3,"formGroup"],[1,"abms-edit-profile__label"],[3,"control"],["pInputText","","formControlName","fullname",1,"w-17rem"],["pInputText","","formControlName","email",1,"w-17rem"],["pInputText","","formControlName","phoneNumber",1,"w-17rem"],[1,"flex","mt-4"],["icon","pi pi-check","iconPos","right",1,"ml-auto",3,"onClick","label"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"form",1)(2,"p",2),p(3),a(4,"translate"),o(),r(5,"app-control-error-wrapper",3),f(6,"input",4),o(),r(7,"p",2),p(8),a(9,"translate"),o(),r(10,"app-control-error-wrapper",3),f(11,"input",5),o(),r(12,"p",2),p(13),a(14,"translate"),o(),r(15,"app-control-error-wrapper",3),f(16,"input",6),o()(),r(17,"footer",7)(18,"p-button",8),a(19,"translate"),S("onClick",function(){return n.onSave()}),o()()(),b(20,de,1,0,"app-overlay-loader"),a(21,"async")),e&2&&(i(),d("formGroup",n.form),i(2),c("",l(4,9,"full_name"),":"),i(2),d("control",n.getFormControlByName("fullname")),i(3),c("",l(9,11,"email"),":"),i(2),d("control",n.getFormControlByName("email")),i(3),c("",l(14,13,"phone_number"),":"),i(2),d("control",n.getFormControlByName("phoneNumber")),i(3),d("label",l(19,15,"save")),i(2),w(l(21,17,n.isLoading$)?20:-1))},dependencies:[ee,Z,D,C,Y,J,q,W,H,K,Q,I,re,L,M],styles:[".abms-edit-profile__form[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 3fr;gap:1.5rem 1rem;align-items:center}.abms-edit-profile__label[_ngcontent-%COMP%]{justify-self:end}"]})};function ce(m,t){if(m&1){let e=j();r(0,"div",3)(1,"h2",4),p(2),a(3,"translate"),o(),r(4,"p-button",5),a(5,"translate"),S("onClick",function(){U(e);let v=N();return O(v.onEdit())}),o()()}m&2&&(i(2),u(l(3,3,"your_data")),i(2),d("label",l(5,5,"edit"))("outlined",!0))}function fe(m,t){if(m&1&&(r(0,"div",6)(1,"p",7),p(2),a(3,"translate"),o(),r(4,"p"),p(5),o(),r(6,"p",7),p(7),a(8,"translate"),o(),r(9,"p"),p(10),a(11,"translate"),o(),r(12,"p",7),p(13),a(14,"translate"),o(),r(15,"p"),p(16),a(17,"translate"),o()()),m&2){let e=N();i(2),c("",l(3,6,"email"),":"),i(3),u(e.userData.email),i(2),c("",l(8,8,"full_name"),":"),i(3),u(l(11,10,e.userData.fullname||"lack_of")),i(3),c("",l(14,12,"phone_number"),":"),i(3),u(l(17,14,e.userData.phoneNumber||"lack_of"))}}var ne=class m{constructor(t,e,n,v){this.userService=t;this.dialogService=e;this.translation=n;this.toastService=v;this.userData=this.userService.activeUser||{}}userData;_destroying$=new g;onEdit(){this.dialogService.open(P,{header:this.translation.instant("edit_profile"),width:"35%"}).onClose.pipe(_(this._destroying$)).subscribe(e=>{e===!0?this.toastService.showSuccess(this.translation.instant("success"),this.translation.instant("your_profile_has_been_updated")):e===!1&&this.toastService.showError(this.translation.instant("error"),this.translation.instant("error_occured_try_again_later"))})}ngOnDestroy(){this._destroying$.next(void 0),this._destroying$.complete()}static \u0275fac=function(e){return new(e||m)(s(E),s(x),s(V),s(G))};static \u0275cmp=h({type:m,selectors:[["app-profile"]],standalone:!0,features:[k([x]),y],decls:3,vars:0,consts:[[1,"abms-profile"],["pTemplate","header"],["pTemplate","content"],[1,"flex","w-full","justify-content-center","align-items-center","relative","mt-2"],[1,"text-lg","font-semibold"],["icon","pi pi-user-edit","iconPos","right",1,"ml-auto","absolute","right-0",3,"onClick","label","outlined"],[1,"abms-profile__user-data-container","mb-4","mt-3"],[1,"abms-profile__label"]],template:function(e,n){e&1&&(r(0,"p-panel",0),b(1,ce,6,7,"ng-template",1)(2,fe,18,16,"ng-template",2),o())},dependencies:[ie,te,R,I,D,C],styles:[".abms-profile__user-data-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.abms-profile__label[_ngcontent-%COMP%]{justify-self:end}"]})};export{ne as ProfileComponent};
